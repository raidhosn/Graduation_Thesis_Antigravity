@import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;1,400;1,500&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

/* ============================================
   SIDEBAR TYPOGRAPHY - Georgia Serif System
   Complete Font & Typography Configuration
   ============================================ */

/* Force Georgia on all sidebar elements */
aside,
[data-sidebar],
.sidebar,
aside * {
  font-family: Georgia, serif !important;
}

/* Sidebar Header ("Table of Contents") */
.sidebar-header-title {
  font-family: Georgia, serif !important;
  font-size: 1.125rem !important;
  /* 18px */
  font-weight: 700 !important;
  line-height: 1.3;
  letter-spacing: normal;
  color: #1a1a1a !important;
  margin: 0 0 2px 0;
}

/* Sidebar Subtitle ("Immersive Virtual Reality â€” 1999") */
.sidebar-header-subtitle {
  font-family: Georgia, serif !important;
  font-size: 0.875rem !important;
  /* 14px */
  font-weight: 400 !important;
  line-height: 1.5;
  color: #6b7280 !important;
  margin-bottom: 1.5rem;
}

/* Main nav items (Main Page, Table of Contents) */
.sidebar-nav-item {
  font-family: Georgia, serif !important;
  font-size: 0.9375rem !important;
  /* 15px */
  font-weight: 500 !important;
  line-height: 1.375;
  color: #1a1a1a !important;
  height: 44px;
  padding: 10px 12px;
  border-radius: 6px;
  background-color: transparent;
  cursor: pointer;
  transition: color 150ms ease-out, background-color 150ms ease-out;
}

.sidebar-nav-item:hover {
  color: #0d9488 !important;
  background-color: rgba(240, 253, 250, 0.5) !important;
}

.sidebar-nav-item.active {
  color: #0d9488 !important;
  background-color: rgba(240, 253, 250, 0.3) !important;
  font-weight: 600 !important;
}

/* Chapter Button Container */
.sidebar-chapter {
  font-family: Georgia, serif !important;
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  height: 44px;
  padding: 10px 12px;
  border-radius: 6px;
  background-color: transparent;
  cursor: pointer;
  transition: color 150ms ease-out, background-color 150ms ease-out;
}

/* Chapter Number */
.sidebar-chapter-number {
  font-family: Georgia, serif !important;
  font-size: 0.9375rem !important;
  /* 15px */
  font-weight: 400 !important;
  color: #6b7280 !important;
}

/* Chapter Title */
.sidebar-chapter-text {
  font-family: Georgia, serif !important;
  font-size: 0.9375rem !important;
  /* 15px */
  font-weight: 500 !important;
  line-height: 1.375;
  color: #1a1a1a !important;
}

.sidebar-chapter:hover {
  background-color: rgba(240, 253, 250, 0.5) !important;
}

.sidebar-chapter:hover .sidebar-chapter-text,
.sidebar-chapter:hover .sidebar-chapter-number {
  color: #0d9488 !important;
}

/* Active Chapter State */
.sidebar-chapter.active,
.sidebar-chapter[data-active="true"] {
  background-color: rgba(240, 253, 250, 0.3) !important;
}

.sidebar-chapter.active .sidebar-chapter-text,
.sidebar-chapter[data-active="true"] .sidebar-chapter-text {
  font-weight: 600 !important;
  color: #0d9488 !important;
}

.sidebar-chapter.active .sidebar-chapter-number,
.sidebar-chapter[data-active="true"] .sidebar-chapter-number {
  color: #0d9488 !important;
}

/* Subsection Button */
.sidebar-subsection,
.sidebar-subsection-text {
  font-family: Georgia, serif !important;
  font-size: 0.875rem !important;
  /* 14px - minimum */
  font-weight: 400 !important;
  line-height: 1.4 !important;
  color: #4b5563 !important;
}

.sidebar-subsection {
  text-align: left;
  min-height: 40px;
  padding: 8px 12px 8px 20px;
  margin-left: 16px;
  border-left: 2px solid #e5e5e5;
  border-radius: 0 6px 6px 0;
  background-color: transparent;
  cursor: pointer;
  transition: color 150ms ease-out, background-color 150ms ease-out, border-color 150ms ease-out;
}

.sidebar-subsection:hover {
  color: #0d9488 !important;
  background-color: rgba(240, 253, 250, 0.5) !important;
  border-left-color: #0d9488 !important;
}

.sidebar-subsection:hover .sidebar-subsection-text {
  color: #0d9488 !important;
}

/* Active Subsection State */
.sidebar-subsection.active,
.sidebar-subsection[data-active="true"] {
  font-weight: 500 !important;
  color: #0d9488 !important;
  background-color: rgba(240, 253, 250, 0.3) !important;
  border-left-color: #0d9488 !important;
}

.sidebar-subsection.active .sidebar-subsection-text,
.sidebar-subsection[data-active="true"] .sidebar-subsection-text {
  font-weight: 500 !important;
  color: #0d9488 !important;
}

/* Footer */
.sidebar-footer-text {
  font-family: Georgia, serif !important;
  font-size: 0.75rem !important;
  /* 12px */
  font-weight: 400 !important;
  line-height: 1.5;
  color: #6b7280 !important;
}

/* Focus States (Accessibility) */
.sidebar-chapter:focus-visible,
.sidebar-nav-item:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px #0d9488;
}

.sidebar-subsection:focus-visible {
  outline: none;
  box-shadow: inset 0 0 0 2px #0d9488;
}


/* Scroll margin for anchors - accounts for sticky header */
[id] {
  scroll-margin-top: 90px;
}

/* Definition of the design system. All colors, gradients, fonts, etc should be defined here. 
All colors MUST be HSL.
*/

@layer base {
  :root {
    /* Academic Typography System - Single Source of Truth */
    /* Background: #f8f7f5 = hsl(40, 20%, 97%) */
    --background: 40 20% 97%;
    /* Foreground/Body: #1a1a1a = hsl(0, 0%, 10%) */
    --foreground: 0 0% 10%;
    /* Secondary text: #333333 = hsl(0, 0%, 20%) */
    --secondary-text: 0 0% 20%;

    --card: 40 20% 99%;
    --card-foreground: 0 0% 10%;

    --popover: 40 20% 99%;
    --popover-foreground: 0 0% 10%;

    /* Primary/Accent: #2d6b80 = hsl(195, 47%, 34%) */
    --primary: 195 47% 34%;
    --primary-foreground: 40 20% 97%;

    --secondary: 40 20% 94%;
    --secondary-foreground: 0 0% 20%;

    --muted: 40 15% 92%;
    --muted-foreground: 0 0% 40%;

    /* Accent matches primary for academic consistency */
    --accent: 195 47% 34%;
    --accent-foreground: 40 20% 97%;

    --destructive: 0 84% 60%;
    --destructive-foreground: 40 20% 97%;

    /* Dividers: #d0d0d0 = hsl(0, 0%, 82%) */
    --border: 0 0% 82%;
    --input: 0 0% 82%;
    --ring: 195 47% 34%;

    --radius: 0.5rem;

    /* Academic Sidebar - Light Theme */
    --sidebar-background: 0 0% 98%;
    --sidebar-foreground: 0 0% 10%;
    --sidebar-primary: 174 82% 32%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 166 76% 97%;
    --sidebar-accent-foreground: 174 82% 32%;
    --sidebar-border: 220 13% 90%;
    --sidebar-ring: 174 82% 32%;
    --sidebar-muted: 220 9% 46%;
    --sidebar-hover: 220 14% 96%;

    /* Custom tokens */
    --gradient-hero: linear-gradient(135deg, hsl(195, 47%, 34%) 0%, hsl(195, 40%, 45%) 100%);
    --gradient-subtle: linear-gradient(180deg, hsl(40, 20%, 99%) 0%, hsl(40, 20%, 97%) 100%);
    --shadow-elegant: 0 10px 40px -10px hsl(195 47% 34% / 0.15);
    --shadow-card: 0 4px 20px -4px hsl(0 0% 0% / 0.08);
    --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .dark {
    --background: 195 35% 8%;
    --foreground: 40 20% 95%;

    --card: 195 30% 12%;
    --card-foreground: 40 20% 95%;

    --popover: 195 30% 12%;
    --popover-foreground: 40 20% 95%;

    --primary: 195 60% 55%;
    --primary-foreground: 195 35% 8%;

    --secondary: 195 25% 18%;
    --secondary-foreground: 40 20% 95%;

    --muted: 195 25% 16%;
    --muted-foreground: 40 15% 65%;

    --accent: 35 80% 55%;
    --accent-foreground: 195 35% 8%;

    --destructive: 0 62.8% 50%;
    --destructive-foreground: 40 20% 95%;

    --border: 195 25% 20%;
    --input: 195 25% 20%;
    --ring: 195 60% 55%;

    /* Academic Sidebar - Dark Theme */
    --sidebar-background: 0 0% 9%;
    --sidebar-foreground: 0 0% 95%;
    --sidebar-primary: 174 72% 46%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 174 40% 15%;
    --sidebar-accent-foreground: 174 72% 60%;
    --sidebar-border: 220 13% 20%;
    --sidebar-ring: 174 72% 46%;
    --sidebar-muted: 220 9% 60%;
    --sidebar-hover: 220 14% 18%;

    /* Custom tokens */
    --gradient-hero: linear-gradient(135deg, hsl(195, 60%, 20%) 0%, hsl(195, 50%, 30%) 100%);
    --gradient-subtle: linear-gradient(180deg, hsl(195, 35%, 10%) 0%, hsl(195, 35%, 8%) 100%);
    --shadow-elegant: 0 10px 40px -10px hsl(195 60% 55% / 0.3);
    --shadow-card: 0 4px 20px -4px hsl(195 60% 55% / 0.2);
  }
}

@layer base {
  * {
    @apply border-border;
  }

  html {
    font-size: 16px;
  }

  /* GLOBAL ACADEMIC TYPOGRAPHY - NO EXCEPTIONS */
  body {
    @apply bg-background text-foreground;
    font-family: 'Georgia', 'Crimson Text', 'Times New Roman', serif !important;
    font-feature-settings: "kern" 1, "liga" 1;
    font-size: 16px !important;
    line-height: 1.6 !important;
  }

  /* Force Georgia on ALL elements - NO EXCEPTIONS */
  *,
  *::before,
  *::after {
    font-family: inherit;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  p,
  span,
  div,
  a,
  button,
  label,
  input,
  textarea,
  select,
  li,
  td,
  th,
  figcaption,
  blockquote {
    font-family: 'Georgia', 'Crimson Text', 'Times New Roman', serif !important;
  }

  /* Buttons - ensure academic typography */
  button,
  .btn,
  [role="button"] {
    font-family: 'Georgia', 'Crimson Text', 'Times New Roman', serif !important;
    font-weight: 500 !important;
    letter-spacing: 0 !important;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    @apply text-foreground;
    letter-spacing: -0.3px;
  }

  /* Academic heading scale - STRICT */
  h1 {
    font-size: 1.75rem !important;
    /* 28px */
    line-height: 1.2 !important;
    font-weight: 700 !important;
    margin-bottom: 1rem;
  }

  h2 {
    font-size: 1.25rem !important;
    /* 20px */
    line-height: 1.3 !important;
    font-weight: 600 !important;
    margin-top: 2rem;
    margin-bottom: 1rem;
  }

  /* Section Headings - h3 */
  h3,
  .section-heading {
    font-size: 1.125rem !important;
    /* 18px */
    line-height: 1.375 !important;
    font-weight: 600 !important;
    color: #1a1a1a !important;
    margin-top: 2rem !important;
    /* 32px */
    margin-bottom: 0.75rem !important;
    /* 12px */
    text-transform: none !important;
    letter-spacing: normal !important;
  }

  /* Subsection Headings - h4 */
  h4,
  .subsection-heading {
    font-size: 1rem !important;
    /* 16px */
    line-height: 1.375 !important;
    font-weight: 600 !important;
    color: #1a1a1a !important;
    margin-top: 1.5rem !important;
    /* 24px */
    margin-bottom: 0.5rem !important;
    /* 8px */
    text-transform: none !important;
  }

  /* Body Text - p */
  p,
  .body-text {
    font-size: 1rem !important;
    /* 16px */
    font-weight: 400 !important;
    color: #374151 !important;
    line-height: 1.75 !important;
    text-align: justify !important;
    max-width: 65ch;
    margin-bottom: 1.5rem !important;
    /* 24px */
  }

  /* Lists inherit sensible spacing */
  ul,
  ol {
    margin-bottom: 1.5rem;
    padding-left: 1.5rem;
  }

  li {
    font-size: 1rem !important;
    margin-bottom: 0.25rem;
    line-height: 1.75 !important;
    color: #374151 !important;
  }

  /* Blockquotes */
  blockquote {
    font-family: Georgia, serif !important;
    font-style: italic !important;
    font-size: 1rem !important;
    /* 16px */
    color: #4b5563 !important;
    border-left: 3px solid #d1d5db !important;
    padding-left: 1.25rem !important;
    margin: 1.5rem 0 !important;
    line-height: 1.75 !important;
  }

  /* Figure captions */
  figcaption,
  .figure-caption {
    font-family: Georgia, serif !important;
    font-style: italic !important;
    font-size: 0.875rem !important;
    /* 14px */
    color: #6b7280 !important;
    text-align: center !important;
    margin-top: 0.5rem !important;
    /* 8px */
    margin-bottom: 1.5rem !important;
    /* 24px */
    line-height: 1.5 !important;
  }

  /* Links use accent color */
  a {
    color: hsl(var(--primary));
  }

  a:hover {
    text-decoration: underline;
  }

  /* Dividers */
  hr {
    border: none;
    border-top: 1px solid hsl(var(--border));
    margin: 2rem 0;
  }
}

@layer utilities {

  /* Academic prose container - constrained line length */
  .prose-academic {
    max-width: 65ch !important;
    margin-left: auto;
    margin-right: auto;
    padding: 24px;
  }

  @media (min-width: 768px) {
    .prose-academic {
      padding: 48px;
    }
  }

  /* ========================================
     CHAPTER TITLE - "Chapter 1"
     Font: Georgia, Size: 32px, Weight: 700
     ======================================== */
  .chapter-title,
  .prose-academic .chapter-title {
    font-family: Georgia, 'Crimson Text', 'Times New Roman', serif !important;
    font-size: 1.75rem !important;
    /* 28px */
    font-weight: 700 !important;
    color: #1a1a1a !important;
    margin-bottom: 0.5rem !important;
    /* 8px */
    line-height: 1.2 !important;
    letter-spacing: normal !important;
    border: none !important;
    background: none !important;
    padding: 0 !important;
  }

  /* ========================================
     CHAPTER SUBTITLE - "Fundamental Concepts"
     Font: Georgia, Size: 18px, Weight: 400
     ======================================== */
  .chapter-subtitle,
  .prose-academic .chapter-subtitle {
    font-family: Georgia, 'Crimson Text', 'Times New Roman', serif !important;
    font-size: 1.125rem !important;
    /* 18px */
    font-weight: 400 !important;
    color: #4b5563 !important;
    /* gray-600 */
    margin-bottom: 2rem !important;
    /* 32px */
    line-height: 1.4 !important;
  }

  /* ========================================
     SECTION HEADINGS - "1.1. Cyberspace"
     Font: Georgia, Size: 20px, Weight: 600
     NO background, NO border
     ======================================== */
  .section-heading,
  .prose-academic h3,
  .prose-academic .section-heading {
    font-family: Georgia, 'Crimson Text', 'Times New Roman', serif !important;
    font-size: 1.25rem !important;
    /* 20px */
    font-weight: 600 !important;
    color: #1a1a1a !important;
    margin-top: 2.5rem !important;
    /* 40px */
    margin-bottom: 1rem !important;
    /* 16px */
    line-height: 1.3 !important;
    letter-spacing: normal !important;
    /* Explicitly remove any styling */
    background: none !important;
    background-color: transparent !important;
    border: none !important;
    padding: 0 !important;
  }

  /* ========================================
     BODY TEXT
     Font: Georgia, Size: 16px, Weight: 400
     Color: gray-700, Line-height: 1.75
     ======================================== */
  .body-text,
  .prose-academic p {
    font-family: Georgia, 'Crimson Text', 'Times New Roman', serif !important;
    font-size: 1rem !important;
    /* 16px */
    font-weight: 400 !important;
    color: #374151 !important;
    /* gray-700 */
    line-height: 1.75 !important;
    text-align: justify !important;
    max-width: 65ch !important;
    margin-bottom: 1.5rem !important;
    /* 24px */
    hyphens: auto;
  }

  /* ========================================
     BLOCK QUOTES
     Font: Georgia italic, Size: 16px
     Left border: 3px solid #e5e5e5
     ======================================== */
  .block-quote,
  .prose-academic blockquote {
    font-family: Georgia, 'Crimson Text', 'Times New Roman', serif !important;
    font-style: italic !important;
    font-size: 1rem !important;
    /* 16px */
    font-weight: 400 !important;
    color: #4b5563 !important;
    /* gray-600 */
    padding-left: 1.5rem !important;
    /* 24px */
    border-left: 3px solid #e5e5e5 !important;
    margin: 1.5rem 0 !important;
    /* 24px */
    background: none !important;
    background-color: transparent !important;
  }

  /* ========================================
     H1 - For main page titles
     ======================================== */
  .prose-academic h1 {
    font-family: Georgia, 'Crimson Text', 'Times New Roman', serif !important;
    font-size: 2rem !important;
    /* 32px */
    font-weight: 700 !important;
    color: #1a1a1a !important;
    margin-bottom: 0.5rem !important;
    line-height: 1.2 !important;
    border: none !important;
    padding: 0 !important;
  }

  /* ========================================
     H2 - Chapter-level headings
     ======================================== */
  .prose-academic h2 {
    font-family: Georgia, 'Crimson Text', 'Times New Roman', serif !important;
    font-size: 1.5rem !important;
    /* 24px */
    font-weight: 600 !important;
    color: #1a1a1a !important;
    margin-top: 2.5rem !important;
    margin-bottom: 1rem !important;
    line-height: 1.3 !important;
    background: none !important;
    border: none !important;
    padding: 0 !important;
  }

  .prose-academic ul,
  .prose-academic ol {
    margin-bottom: 1.5rem !important;
    padding-left: 1.5rem;
  }

  .prose-academic li {
    font-family: Georgia, 'Crimson Text', 'Times New Roman', serif !important;
    font-size: 1rem !important;
    font-weight: 400 !important;
    color: #374151 !important;
    margin-bottom: 0.5rem;
    line-height: 1.75 !important;
  }

  .prose-academic figure {
    margin: 2rem 0;
  }

  .prose-academic figcaption {
    font-family: Georgia, 'Crimson Text', 'Times New Roman', serif !important;
    font-size: 0.875rem !important;
    text-align: center;
    color: #6b7280 !important;
    margin-top: 0.75rem;
    font-style: italic;
  }

  /* Section dividers */
  .prose-academic hr {
    border: none;
    border-top: 1px solid #e5e5e5;
    margin: 2.5rem 0;
  }

  /* Citation styling */
  .prose-academic em {
    font-style: italic;
  }

  .prose-academic strong {
    font-weight: 600 !important;
  }

  /* Secondary text utility */
  .text-secondary {
    color: hsl(var(--secondary-text)) !important;
  }
}

@layer components {

  /* Sidebar typography classes - Academic design system */
  .sidebar-header-text {
    font-family: Georgia, 'Crimson Text', 'Times New Roman', serif;
    font-size: 1.125rem;
    font-weight: 600;
    line-height: 1.25;
  }

  .sidebar-chapter-text {
    font-family: Georgia, 'Crimson Text', 'Times New Roman', serif;
    font-size: 1rem;
    font-weight: 500;
    line-height: 1.375;
  }

  .sidebar-chapter-number {
    font-family: Georgia, 'Crimson Text', 'Times New Roman', serif;
    font-size: 0.875rem;
    font-weight: 400;
  }

  .sidebar-subsection-text {
    font-family: Georgia, 'Crimson Text', 'Times New Roman', serif;
    font-size: 0.875rem;
    font-weight: 400;
    line-height: 1.375;
  }

  .sidebar-footer-text {
    font-family: Georgia, 'Crimson Text', 'Times New Roman', serif;
    font-size: 0.75rem;
    font-weight: 400;
    line-height: 1.5;
  }

  /* Sidebar transition utility */
  .sidebar-transition {
    transition-property: color, background-color, border-color;
    transition-duration: 150ms;
    transition-timing-function: ease-out;
  }

  /* Subsection expand/collapse animation */
  .subsection-collapsed {
    max-height: 0;
    opacity: 0;
    overflow: hidden;
  }

  .subsection-expanded {
    max-height: 24rem;
    opacity: 1;
  }

  .subsection-animate {
    transition: max-height 200ms ease-out, opacity 200ms ease-out;
  }

  /* TOC Card Subsection (main page) - with hover effects */
  .toc-card-subsection {
    font-family: Georgia, serif;
    font-size: 1rem;
    /* 16px */
    font-weight: 400;
    color: #6b7280;
    padding: 8px 12px;
    background: transparent;
    border-left: 3px solid transparent;
    cursor: pointer;
    transition: all 150ms ease-out;
    display: block;
    text-decoration: none;
  }

  .toc-card-subsection:hover {
    color: #0d9488;
    background-color: rgba(240, 253, 250, 0.5);
    border-left-color: #0d9488;
  }

  .toc-card-subsection:active,
  .toc-card-subsection.active {
    color: #0d9488;
    background-color: rgba(240, 253, 250, 0.3);
    border-left-color: #0d9488;
    font-weight: 500;
  }
}